<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="asset/css/resetPassword.css">
</head>

<body>
    <div class="wrapper fadeInDown">
        <div id="formContent">

            <div class="fadeIn first">
                <div class="row justify-content-md-center" style="padding-top: 15px;">
                    <img src="asset/img/index.jpg" class="img-fluid" alt="Responsive image">
                </div>
            </div>



            <input type="password" id="newPassword" class="fadeIn second" name="login" placeholder="New password">
            <input type="password" id="reNewPassword" class="fadeIn third" name="login" placeholder="Re-enter new password">
            <input type="button" class="fadeIn fourth" value="Change password" onclick="handleRePassword()">



            <div id="formFooter">
                <a class="underlineHover" href="#">สถาบันสารสนเทศ ทรัพยากรน้ำเเละการเกษตร</a>
            </div>

        </div>
    </div>
</body>
<script>
    function handleRePassword() {
        let newPassword = $('#newPassword').val();
        let reNewPassword = $('#reNewPassword').val();
        let url_string = window.location.href;
        let urlParam = new URL(url_string);
        let info = urlParam.searchParams.get("info");
        if (newPassword != "" && reNewPassword != "" && (newPassword == reNewPassword)) {
            $.post("./User/updatePassword", { info: info, password: newPassword }, (resp) => {
               // console.log(resp);
                let { status } = JSON.parse(resp);
                if (status) {
                    alert("Update Success");
                    window.location.href = "./";
                }else{
                    alert("Update Failed");
                }
            })
        } else {
            alert("Error");
        }
    }

</script>

</html>